# 건설사 ERP시스템 프로젝트


## 1️⃣ 수행 기간 및 개발 목표

### 수행 기간
2024년 08월 05일 ~ 2024년 10월 31일

### 개발 목표
현장별 관리 및 자재 입고, 발주 관리와  회사 내부 인사관리 및 시스템 설정


## 2️⃣ 개발 환경
![image](https://github.com/user-attachments/assets/fc5ec4a8-e687-466b-93f0-9b99942d29f3)


## 3️⃣ DB 설계
![image](https://github.com/user-attachments/assets/8d7232b7-6a64-4152-b141-459023ebc505)


## 4️⃣ 구현 기능 및 담당 역할
![image](https://github.com/user-attachments/assets/b2107686-409a-4f0d-9c41-a968d3f8b73a)

![image](https://github.com/user-attachments/assets/13012dc5-3f41-405e-9fef-ace01eb61820)

![image](https://github.com/user-attachments/assets/d605038f-394b-40df-8b8f-9f96e44d5006)
구현기능설명 : 
 패스워드 오류를 카운트하여 5회 이상 틀릴 경우 DB login_success컬럼에 N으로 insert하여 아이디 차단.
 로그인 할 때 차단된 아이디 조건 걸어 계정 잠금 다시 한번 확인 조건 추가.
 DB에 퇴사일이 존재하면 계정 차단 조건 추가.
 패스워드 변경일과 변경일 일수 차이가 90일 이상일 경우 계정 잠금 조건 추가.
패스워드 변경일과 변경일 일수차이가 75일, 85일 이상일 경우 main으로 넘기고 변경 form불러오기.
 부서를 코드화하여 DB 관리함. 부서별 직원들을 관리. 직원을 검색할 때 조회되는 쿼리 where절에 선택한 날짜, 입력한 부서, 아이디, 이름, 이메일을 넣어 조회되도록 함.
 비밀번호는 1개월 이내 바꾼 비밀번호 체크.


![image](https://github.com/user-attachments/assets/fa19865a-b1c5-4698-ab73-6bc886c04eda)
구현기능설명 : 로그인 기록 조회 기능은 로그인 할 때 사용자의 Request 객체의 ip() 메서드, userAgent(), date를 가져와 db에 저장하고 Query Builder를 사용해 현재 로그인한 사용자의 로그인 이력을 users_login_history 테이블에서 조회함. 이후, 정렬 기준이 설정되지 않은 경우 기본값으로 내림차순 정렬을 적용하며, 구성된 데이터는 Blade 템플릿 뷰로 렌더링해 화면에 출력함


![image](https://github.com/user-attachments/assets/d09e867f-b982-4779-afd5-9e01efbb3c4e)
구현기능설명 :
 직원 정보를 검색하고 정렬하여 직원 목록을 필터링한 후, 뷰에 전달.
 직원의 메뉴 권한을 조회하여 해당 직원의 권한 상태를 함. 각 메뉴들을 숫자로 코드화 하여 체크박스에 체크한 메뉴를 저장하면 user테이블의 permit컬럼에 저장되어 유저의 권한 추가, 수정, 삭제, 조회 가능.


![image](https://github.com/user-attachments/assets/1371ca88-24d9-4cbb-8543-178cb897379d)
구현기능설명:
1. Query Builder를 이용해 발주된 리스트들을 조회, 클릭하면 popup창으로 연결 새로운 창이 뜨도록하여 개별 관리 가능함. Script를 이용해 항목추가, 항목삭제를 통해 표 변경이 가능하며, 코드 박스를 클릭하면 modal창이 떠 계약수량의 코드를 검색 할 수 있다. 검색한 코드를 선택하고 수량을 입력하면 자동으로 금액이 계산되며, 합계 또한 실시간으로 script를 통해 계산됨. 

 2. PHPdompdf 라이브러리를 사용하여 HTML을 PDF 파일로 변환하고 출력이 가능. HTML과 CSS로 표 레이아웃을 만들고, PHP 데이터를 동적으로 삽입한 Blade 파일을 컨트롤러에서 Pdf::loadView를 사용하여 blade뷰를 로드하고, 조회된 데이터를 PDF로 변환

 
![image](https://github.com/user-attachments/assets/a099b32b-4338-42d3-8f20-6114b7a963b0)
구현기능설명:
1. PHPExcel 라이브러리를 사용하여 
발주서 정보를 엑셀 파일로 다운로드 가능. 데이터가 많아 엑셀 다운이 끊기는 것을 방지하기 위해 PHP의 ini_set을 사용해 실행 시간과 메모리 제한을 설정하고, 클라이언트로부터 받은 파라미터를 바탕으로 엑셀 파일의 기본을 설정. 발주서 상단에 필요한 정보를 엑셀 데이터에 추가하고, 각 품목에 대한 계약 정보를 DB에서 조회하여 엑셀 파일에 삽입. 이후 특이사항을 포함한 추가 정보를 엑셀 시트에 작성하고, 셀 병합, 정렬, 테두리, 너비 등의 스타일을 설정함. 생성된 엑셀 파일은 지정된 경로에 저장하고, 다운로드 로그를 업데이트한 후, 성공 여부와 함께 결과를 반환.


2. Modal창을 이용해 등록폼을 띄우고 계약 정보를 조회하여 form에 전달하고, 삭제 시 계약을 비활성화하고, 수정 시 중복 코드와 가격을 체크하여 업데이트하며, 등록 시 새로운 계약 정보를 추가함. 각 작업은 성공 여부를 반환하며, 성공 시 처리 완료 메시지를, 실패 시 관리자에게 문의하라는 메시지를 제공.


3. 테이블을 조인하여 특정 발주 정보에 해당하는 계약 정보를 조회함. 사용자가 입력한 keyword에 따라 계약명, 카테고리, 코드, 규격 등 여러 필드에서 검색하여 최신 순으로 정렬함.  한 페이지에 최대 10개의 계약 정보를 반환하도록 페이징 처리했으며,  전체 계약 수와 함께 결과를 출력함. 


